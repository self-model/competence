---
title: "Better tahn average comparisons"
output: html_notebook
---

Better-than-average comparisons for Prediction Position and Self-Rating 

LOAD PACKAGES

```{r setup, include = FALSE}
library('groundhog')
groundhog.library(
  c(
    'papaja', #for apa formatting
    'pwr', # for power calculation
    'tidyverse', # for pipe %>%
    'emmeans',
    'afex',
    'patchwork',
    'officer',
    'cowplot',
    'ggrepel',
    'dplyr',
    'BayesFactor'
  ), "2024-04-09"
)

knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, results='hide')
```

LOAD CSV

```{r}
pilot.df <- read.csv("combined_pilot_batches.csv", na=c("")) %>%
  filter(!(word %in% c('', 'ZEBRA'))) %>%
  mutate(subj_id=PROLIFIC_PID)
pilot.df
```


PREPARE DATAFRAMES

```{r}
data_from_games <- pilot.df %>%
  filter(trial_type=='Hangman_replay') %>%
  dplyr::select(subj_id,word,num_clicks) 
data_from_games

data_from_confidence <- read.csv("combined_pilot_batches.csv") %>%
  mutate(subj_id=PROLIFIC_PID,
         confidence=as.numeric(confidence_slider_self_response)) %>%
  group_by(subj_id) %>%
  summarise(
    confidence=mean(confidence,na.rm=T)
  )
data_from_confidence

data_from_guesses <- pilot.df %>%
  filter(trial_type=='Guess_leaderboard') %>%
  dplyr::select(subj_id,subject_pair,word,position,position_RT,true_position,reveal_word,player,distance, self_rating)
data_from_guesses
          
#Merge above to new usable, filtered dataframe
filtered_df <- data_from_games %>%
  merge(data_from_guesses) %>%
  merge(data_from_confidence)
filtered_df

#Change variables from characters to correct classification 
#Change reveal_word into a categorical variable
filtered_df$reveal_word <- factor(filtered_df$reveal_word)
#Change position into an integer variable 
filtered_df$position <- as.integer(filtered_df$position)
#Change true_position into an integer variable
filtered_df$true_position <- as.integer(filtered_df$true_position)
#Change distance into an integer variable 
filtered_df$distance <- as.integer(filtered_df$distance)
#Change self-rating into an integer
filtered_df$self_rating <- as.integer(filtered_df$self_rating)
#Change word into a categorical variable 
filtered_df$word <- factor(filtered_df$word)
#Change distance into an integer variable 
filtered_df$distance <- as.integer(filtered_df$distance)
#change confidence into an integer variable
filtered_df$confidence <- as.integer(filtered_df$confidence)

#Check variables were changed correctly
#Check class reveal_word
class(filtered_df$reveal_word)
#Check class position 
class(filtered_df$position)
#Check class true position 
class(filtered_df$true_position)
#check class distance 
class(filtered_df$distance)
#check class self rating
class(filtered_df$self_rating)
#check class word 
class(filtered_df$word)
#check class distance 
class(filtered_df$distance)
#check class confidence
class(filtered_df$confidence)

#Rename levels of reveal_word from true and false to revealed and hidden, respectively 
filtered_df$reveal_word <- factor(filtered_df$reveal_word, levels = c("true", "false"), labels = c("revealed", "hidden"))

# Check the levels of reveal_word variable
levels(filtered_df$reveal_word)

#Check changes in filtered_df (which we will be using for our analysis)
print(filtered_df)
```


```{r}
#Creating the mean dataframe
average_position <- filtered_df %>%
  group_by(subj_id) %>%
  summarize(mean_position = mean(position))

# Print the result
print(average_position)

#Next, for self-rating 
average_self_rating <- filtered_df %>%
  group_by(subj_id) %>%
  summarize(mean_self_rating = mean(self_rating))

# Print the result
print(average_self_rating)

#Now, for confidence 
average_confidence <- filtered_df %>%
  group_by(subj_id) %>%
  summarize(mean_confidence = mean(confidence))

# Print the result
print(average_confidence)

#Now for accuracy
average_distance <- filtered_df %>%
  group_by(subj_id) %>%
  summarize(mean_distance = mean(distance))

# Print the result
print(average_distance)

#Reveal word (condition) datframe 
data_from_conditions <- pilot.df %>%
  filter(trial_type=='Guess_leaderboard') %>%
  dplyr::select(subj_id,subject_pair,reveal_word) %>%
distinct(subj_id,subject_pair,reveal_word)
data_from_conditions

#Now, to merge the mean variables with each other, and with condition.  
subj_mean_df <- data_from_conditions %>%
  merge(average_position) %>%
  merge(average_self_rating) %>%
  merge(average_confidence)%>%
  merge(average_distance)
subj_mean_df

#Change variables to correct classification
#Change reveal_word into a categorical variable
subj_mean_df$reveal_word <- factor(subj_mean_df$reveal_word)
#Change subject pair into a categorical variable
subj_mean_df$subject_pair <- factor(subj_mean_df$subject_pair)
#Change position into an integer variable 
subj_mean_df$mean_position <- as.integer(subj_mean_df$mean_position)
#Change self-rating into an integer
subj_mean_df$mean_self_rating <- as.integer(subj_mean_df$mean_self_rating)
#Change distance into an integer
subj_mean_df$mean_distance <- as.integer(subj_mean_df$mean_distance)

#Check variables were changed correctly
#Check class reveal_word
class(subj_mean_df$reveal_word)
#Check class subject pair
class(subj_mean_df$subject_pair)
#Check class position 
class(subj_mean_df$mean_position)
#check class self rating
class(subj_mean_df$mean_self_rating)
#check class distance
class(subj_mean_df$mean_distance)

#Rename levels of reveal_word from true and false to revealed and hidden, respectively 
subj_mean_df$reveal_word <- factor(subj_mean_df$reveal_word, levels = c("true", "false"), labels = c("revealed", "hidden"))

# Check the levels of reveal_word variable
levels(subj_mean_df$reveal_word)

#Check mean dataframe changed correctly 
subj_mean_df
```

#### T-test prediting position compared to an average

Run a t-test on mean ratings per subject (200 values overall) against 50.5, to see if participants predict better-than-average performance.

```{r}
t_test_result_mean_position <- t.test(subj_mean_df$mean_position, mu = 50.5)
t_test_result_mean_position
```
Work out SD 

```{r}
sd_mean_position <- sd(subj_mean_df$mean_position)
sd_mean_position
```



#### T-test predicting self-rating against an average

Run a t-test on self-ratings (200 values overall) against 3.5 to see if participants predict better-than-average performance for themselves.

```{r}
t_test_mean_self_rating <- t.test(subj_mean_df$mean_self_rating, mu = 3.5)
t_test_mean_self_rating
```

```{r}
sd_mean_self_rating <- sd(subj_mean_df$mean_self_rating)
sd_mean_self_rating
```






